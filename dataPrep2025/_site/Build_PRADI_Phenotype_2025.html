<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>PRADI Data Prep 2025</title>

<script src="site_libs/header-attrs-2.29/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/lumen.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>






<link rel="stylesheet" href="style.css" type="text/css" />



<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">My Website</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="Build_WRAP_Phenotype_2025.html">WRAP</a>
</li>
<li>
  <a href="Build_PRADI_Phenotype_2025.html">PRADI</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">PRADI Data Prep 2025</h1>

</div>


<p>Author: Mengna Zhang</p>
<p><em>Last updated on:</em> 2025-07-10</p>
<div id="set-path" class="section level1">
<h1>Set Path</h1>
<pre class="r"><code>#directory
directory &lt;- &quot;/Users/mengnazhang/Desktop/&quot;
my_directory &lt;- paste0(directory, &quot;ADSP_DataPrep_local/PRADI/Phenotype/2025/Raw/&quot;)

## colnames excel file location
colnames_file &lt;- &quot;/Users/mengnazhang/Desktop/ADSP_DataPrep_local/PRADI/Phenotype/2025/Clean/colnamesPerSubdata.xlsx&quot;</code></pre>
<p><br></p>
</div>
<div id="load-packages" class="section level1">
<h1>Load Packages</h1>
<pre class="r"><code>require(dplyr)
require(readxl)
require(openxlsx)</code></pre>
<p><br></p>
</div>
<div id="load-helper-scripts" class="section level1">
<h1>Load Helper Scripts</h1>
<pre class="r"><code>source(&quot;/Users/mengnazhang/Desktop/ADSP_DataPrep/dataPrep2025/helperScripts.R&quot;)</code></pre>
<p><br> <br></p>
</div>
<div id="sub-files-inspection" class="section level1">
<h1>Sub Files Inspection</h1>
<div id="save-all-sub-file-names" class="section level2">
<h2>Save all sub file names</h2>
<p><strong>Extract all file names</strong></p>
<pre class="bash"><code>mypath=&quot;/Users/mengnazhang/Desktop/ADSP_DataPrep_local/PRADI/Phenotype/2025/Raw/&quot;

ls ${mypath} | grep &quot;.xlsx&quot; &gt; ${mypath}filelist.txt

wc -l ${mypath}filelist.txt ## 38 sub files in total</code></pre>
<pre><code>      38 /Users/mengnazhang/Desktop/ADSP_DataPrep_local/PRADI/Phenotype/2025/Raw/filelist.txt</code></pre>
<p><br> <br></p>
</div>
<div id="load-all-subfiles" class="section level2">
<h2>Load All Subfiles</h2>
<pre class="r"><code>file_list &lt;- paste0(my_directory,&quot;filelist.txt&quot;)

## read all lines (file names) from the file
file_names &lt;- readLines(file_list)

## loop over each file name
for (fname in file_names) {
  ## Extract the clean name by removing prefix and suffix
  clean_name &lt;- sub(&quot;^PRADI_&quot;, &quot;&quot;, fname)
  clean_name &lt;- sub(&quot;_05122025\\.xlsx$&quot;, &quot;&quot;, clean_name)
  
  ## read the Excel file and convert to data.frame
  data &lt;- as.data.frame(read_excel(paste0(my_directory, fname),sheet = &quot;Export Worksheet&quot;))
  
  ## assign to a variable with the clean name in the global environment
  assign(clean_name, data, envir = .GlobalEnv)
  rm(data)
}</code></pre>
<p><br> <br></p>
</div>
<div id="get-common-columns" class="section level2">
<h2>Get Common Columns</h2>
<pre class="r"><code>df_names &lt;- ls()[sapply(mget(ls(), .GlobalEnv), is.data.frame)]

## extract the column names for each data frame
column_lists &lt;- lapply(df_names, function(name) colnames(get(name)))

## find common columns across all data frames
common_cols &lt;- Reduce(intersect, column_lists)

# Print the result
print(common_cols)</code></pre>
<pre><code>##  [1] &quot;SYSXM&quot;         &quot;SYSIND&quot;        &quot;SYSGP&quot;         &quot;SYSGPSTUDY&quot;   
##  [5] &quot;SYSINDGP&quot;      &quot;CGI_ORDER&quot;     &quot;GPS_ORDER&quot;     &quot;STDCGI_ORDER&quot; 
##  [9] &quot;LSTUDY&quot;        &quot;DB_OWNER&quot;      &quot;STUDY&quot;         &quot;SUBSTUDY&quot;     
## [13] &quot;CENTER&quot;        &quot;GP&quot;            &quot;IND&quot;           &quot;REFCTR&quot;       
## [17] &quot;DATE_OF_BIRTH&quot;</code></pre>
<p><br> <br></p>
</div>
<div id="save-all-colnames" class="section level2">
<h2>Save all Colnames</h2>
<pre class="r"><code>## this code only need to be run once
# Create a new workbook
wb &lt;- createWorkbook()

# For each data frame, add a sheet with its column names
# Loop through each data frame
for (df_name in df_names) {
  df &lt;- get(df_name)  # get the actual data frame
  col_names_df &lt;- data.frame(VarNames = colnames(df))  # create single-column df

  # Add sheet with df name (truncated to 31 characters max)
  sheet_name &lt;- substr(df_name, 1, 31)
  addWorksheet(wb, sheetName = sheet_name)

  # Write the column names into the sheet
  writeData(wb, sheet = sheet_name, col_names_df)
}

# Save the workbook
saveWorkbook(wb, file = colnames_file, overwrite = TRUE)</code></pre>
<p><br> <br></p>
</div>
</div>
<div id="variable-check-per-file" class="section level1">
<h1>Variable Check Per File</h1>
<div id="aaad_geriat" class="section level2">
<h2>AAAD_GERIAT</h2>
<pre class="r"><code>str(AAAD_GERIAT)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1051 obs. of  62 variables:
##  $ SYSXM              : num  7534713 7540453 7540583 7540653 7540803 ...
##  $ SYSIND             : num  11108883 11006263 11048913 11048883 11059623 ...
##  $ SYSGP              : num  7920393 7888673 7896183 7896183 7897223 ...
##  $ SYSGPSTUDY         : num  1357713 1304013 1311503 1311503 1312543 ...
##  $ SYSINDGP           : num  7868403 7761063 7804773 7804743 7818553 ...
##  $ CGI_ORDER          : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ GPS_ORDER          : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ STDCGI_ORDER       : num  11 11 11 11 11 11 11 11 11 11 ...
##  $ LSTUDY             : chr  &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADFAMPRADI&quot; ...
##  $ DB_OWNER           : chr  &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; ...
##  $ STUDY              : chr  &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; ...
##  $ SUBSTUDY           : chr  &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADFAMPRADI&quot; ...
##  $ CENTER             : chr  &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; ...
##  $ GP                 : num  87634 87534 87657 87657 87699 ...
##  $ IND                : num  1 104 102 1000 101 108 1 1 1 1 ...
##  $ REFCTR             : logi  NA NA NA NA NA NA ...
##  $ EXAM_DATE          : POSIXct, format: &quot;2018-01-12&quot; &quot;2018-02-21&quot; ...
##  $ EXAMINER           : chr  &quot;axr1589&quot; &quot;v.rodriguez4&quot; &quot;v.rodriguez4&quot; &quot;axr1589&quot; ...
##  $ DATE_OF_BIRTH      : POSIXct, format: &quot;1950-06-03&quot; &quot;1936-09-20&quot; ...
##  $ AGE_AT_EXAM        : num  67 81 72 94 88 68 67 71 68 69 ...
##  $ SATISFIED_LIFE     : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ DROPPED_ACTIVITIES : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ FEEL_EMPTY         : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ GOOD_SPIRIT        : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ AFRAID_BAD_THINGS  : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ BORED              : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;Y&quot; ...
##  $ FEEL_HAPPY         : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_HELPLESS      : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ STAY_HOME          : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ MEMORY_PROBLEM     : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ ALIVE              : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_WORTHLESS     : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ FEEL_FULL_ENERGY   : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_HOPELESS      : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ OTHER_BETTER_OFF   : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ TROUBLE_FALL_ASLEEP: logi  NA NA NA NA NA NA ...
##  $ TROUBLE_STAY_ASLEEP: logi  NA NA NA NA NA NA ...
##  $ SLEEPING_TOO_MUCH  : logi  NA NA NA NA NA NA ...
##  $ APPETITE_INCREASED : logi  NA NA NA NA NA NA ...
##  $ APPETITE_DECREASED : logi  NA NA NA NA NA NA ...
##  $ WEIGHT_LOSS        : logi  NA NA NA NA NA NA ...
##  $ AMOUNT_WEIGHT_LOSS : logi  NA NA NA NA NA NA ...
##  $ SATISFYING_LIFE    : logi  NA NA NA NA NA NA ...
##  $ COMMENTS           : logi  NA NA NA NA NA NA ...
##  $ RELIABLE           : logi  NA NA NA NA NA NA ...
##  $ LIFE_SCORE         : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ ACTIVITY_SCORE     : num  0 0 0 0 1 0 0 0 1 1 ...
##  $ EMPTY_SCORE        : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ BORED_SCORE        : num  0 0 0 1 0 0 0 0 0 0 ...
##  $ SPIRIT_SCORE       : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ AFRAID_SCORE       : num  0 0 0 0 0 0 0 0 1 0 ...
##  $ HAPPY_SCORE        : num  0 0 0 0 0 0 1 0 0 0 ...
##  $ HELPLESS_SCORE     : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ STAY_HOME_SCORE    : num  0 0 0 0 1 1 0 0 1 0 ...
##  $ MEMORY_SCORE       : num  0 0 0 0 1 0 0 0 0 1 ...
##  $ ALIVE_SCORE        : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ WORTHLESS_SCORE    : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ FULL_ENERGY_SCORE  : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ HOPELESS_SCORE     : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ BETTER_OFF_SCORE   : num  0 0 0 0 0 0 1 0 0 1 ...
##  $ TOTAL_STATUS       : chr  NA NA NA NA ...
##  $ TOTAL              : num  0 0 0 1 3 1 2 0 3 6 ...</code></pre>
<pre class="r"><code>## extract character columns and check the unique values for all chracter columns
uniqueValforChrColumns(AAAD_GERIAT)</code></pre>
<pre><code>## LSTUDY :
## [1] &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADCONTROL&quot;  &quot;ADFAM&quot;     
## 
## DB_OWNER :
## [1] &quot;CLINIC_USER&quot;
## 
## STUDY :
## [1] &quot;ALZ&quot;
## 
## SUBSTUDY :
## [1] &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADCONTROL&quot;  &quot;ADFAM&quot;     
## 
## CENTER :
## [1] &quot;IHG&quot;
## 
## EXAMINER :
##  [1] &quot;axr1589&quot;              &quot;v.rodriguez4&quot;         &quot;bxf258&quot;              
##  [4] &quot;avg55&quot;                &quot;ALEJANDRA BETACOURT&quot;  &quot;kxc672&quot;              
##  [7] &quot;RDW&quot;                  &quot;sjt82&quot;                &quot;plb50&quot;               
## [10] &quot;ascott2&quot;              &quot;prm72&quot;                &quot;mxp1257&quot;             
## [13] &quot;erika negro&quot;          &quot;mxc2207&quot;              &quot;Erika Negro&quot;         
## [16] &quot;MP&quot;                   &quot;AS&quot;                   &quot;PM&quot;                  
## [19] &quot;OG&quot;                   &quot;M. prough&quot;            &quot;patricia&quot;            
## [22] &quot;NIT&quot;                  &quot;MICHAEL P&quot;            &quot;M PROUGH&quot;            
## [25] &quot;UCC&quot;                  &quot;CDel&quot;                 &quot;NEREIDA FELICIANO&quot;   
## [28] &quot;erica&quot;                &quot;erika&quot;                &quot;Maricarmen Contreras&quot;
## [31] &quot;xx&quot;                   &quot;fxs121&quot;               &quot;MEDICAL RECORDS&quot;     
## [34] &quot;jjs2031&quot;              &quot;axl4132&quot;              &quot;jmv184&quot;              
## [37] &quot;cmanrique&quot;            &quot;gsv32&quot;                &quot;rmartinez1&quot;          
## 
## SATISFIED_LIFE :
## [1] &quot;Y&quot; &quot;N&quot; NA 
## 
## DROPPED_ACTIVITIES :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## FEEL_EMPTY :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## GOOD_SPIRIT :
## [1] &quot;Y&quot; &quot;N&quot; NA 
## 
## AFRAID_BAD_THINGS :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## BORED :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## FEEL_HAPPY :
## [1] &quot;Y&quot; &quot;N&quot; NA 
## 
## FEEL_HELPLESS :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## STAY_HOME :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## MEMORY_PROBLEM :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## ALIVE :
## [1] &quot;Y&quot; &quot;N&quot; NA 
## 
## FEEL_WORTHLESS :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## FEEL_FULL_ENERGY :
## [1] &quot;Y&quot; &quot;N&quot; NA 
## 
## FEEL_HOPELESS :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## OTHER_BETTER_OFF :
## [1] &quot;N&quot; &quot;Y&quot; NA 
## 
## TOTAL_STATUS :
## [1] NA        &quot;partial&quot;</code></pre>
<pre class="r"><code>## extract logi columns and convert to characters
logicols &lt;- colnames(AAAD_GERIAT)[sapply(AAAD_GERIAT, is.logical)]
AAAD_GERIAT[logicols] &lt;- lapply(AAAD_GERIAT[logicols], as.character)

## convert date format
AAAD_GERIAT[[&quot;EXAM_DATE&quot;]] &lt;- as.Date(AAAD_GERIAT[[&quot;EXAM_DATE&quot;]])
AAAD_GERIAT[[&quot;DATE_OF_BIRTH&quot;]] &lt;- as.Date(AAAD_GERIAT[[&quot;DATE_OF_BIRTH&quot;]])</code></pre>
<pre class="r"><code>str(AAAD_GERIAT)</code></pre>
<pre><code>## &#39;data.frame&#39;:    1051 obs. of  62 variables:
##  $ SYSXM              : num  7534713 7540453 7540583 7540653 7540803 ...
##  $ SYSIND             : num  11108883 11006263 11048913 11048883 11059623 ...
##  $ SYSGP              : num  7920393 7888673 7896183 7896183 7897223 ...
##  $ SYSGPSTUDY         : num  1357713 1304013 1311503 1311503 1312543 ...
##  $ SYSINDGP           : num  7868403 7761063 7804773 7804743 7818553 ...
##  $ CGI_ORDER          : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ GPS_ORDER          : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ STDCGI_ORDER       : num  11 11 11 11 11 11 11 11 11 11 ...
##  $ LSTUDY             : chr  &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADFAMPRADI&quot; ...
##  $ DB_OWNER           : chr  &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; ...
##  $ STUDY              : chr  &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; ...
##  $ SUBSTUDY           : chr  &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; &quot;ADFAMPRADI&quot; &quot;ADFAMPRADI&quot; ...
##  $ CENTER             : chr  &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; ...
##  $ GP                 : num  87634 87534 87657 87657 87699 ...
##  $ IND                : num  1 104 102 1000 101 108 1 1 1 1 ...
##  $ REFCTR             : chr  NA NA NA NA ...
##  $ EXAM_DATE          : Date, format: &quot;2018-01-12&quot; &quot;2018-02-21&quot; ...
##  $ EXAMINER           : chr  &quot;axr1589&quot; &quot;v.rodriguez4&quot; &quot;v.rodriguez4&quot; &quot;axr1589&quot; ...
##  $ DATE_OF_BIRTH      : Date, format: &quot;1950-06-03&quot; &quot;1936-09-20&quot; ...
##  $ AGE_AT_EXAM        : num  67 81 72 94 88 68 67 71 68 69 ...
##  $ SATISFIED_LIFE     : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ DROPPED_ACTIVITIES : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ FEEL_EMPTY         : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ GOOD_SPIRIT        : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ AFRAID_BAD_THINGS  : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ BORED              : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;Y&quot; ...
##  $ FEEL_HAPPY         : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_HELPLESS      : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ STAY_HOME          : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ MEMORY_PROBLEM     : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ ALIVE              : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_WORTHLESS     : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ FEEL_FULL_ENERGY   : chr  &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; &quot;Y&quot; ...
##  $ FEEL_HOPELESS      : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ OTHER_BETTER_OFF   : chr  &quot;N&quot; &quot;N&quot; &quot;N&quot; &quot;N&quot; ...
##  $ TROUBLE_FALL_ASLEEP: chr  NA NA NA NA ...
##  $ TROUBLE_STAY_ASLEEP: chr  NA NA NA NA ...
##  $ SLEEPING_TOO_MUCH  : chr  NA NA NA NA ...
##  $ APPETITE_INCREASED : chr  NA NA NA NA ...
##  $ APPETITE_DECREASED : chr  NA NA NA NA ...
##  $ WEIGHT_LOSS        : chr  NA NA NA NA ...
##  $ AMOUNT_WEIGHT_LOSS : chr  NA NA NA NA ...
##  $ SATISFYING_LIFE    : chr  NA NA NA NA ...
##  $ COMMENTS           : chr  NA NA NA NA ...
##  $ RELIABLE           : chr  NA NA NA NA ...
##  $ LIFE_SCORE         : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ ACTIVITY_SCORE     : num  0 0 0 0 1 0 0 0 1 1 ...
##  $ EMPTY_SCORE        : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ BORED_SCORE        : num  0 0 0 1 0 0 0 0 0 0 ...
##  $ SPIRIT_SCORE       : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ AFRAID_SCORE       : num  0 0 0 0 0 0 0 0 1 0 ...
##  $ HAPPY_SCORE        : num  0 0 0 0 0 0 1 0 0 0 ...
##  $ HELPLESS_SCORE     : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ STAY_HOME_SCORE    : num  0 0 0 0 1 1 0 0 1 0 ...
##  $ MEMORY_SCORE       : num  0 0 0 0 1 0 0 0 0 1 ...
##  $ ALIVE_SCORE        : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ WORTHLESS_SCORE    : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ FULL_ENERGY_SCORE  : num  0 0 0 0 0 0 0 0 0 1 ...
##  $ HOPELESS_SCORE     : num  0 0 0 0 0 0 0 0 0 0 ...
##  $ BETTER_OFF_SCORE   : num  0 0 0 0 0 0 1 0 0 1 ...
##  $ TOTAL_STATUS       : chr  NA NA NA NA ...
##  $ TOTAL              : num  0 0 0 1 3 1 2 0 3 6 ...</code></pre>
<p><br> <br></p>
</div>
<div id="aaad_medcon" class="section level2">
<h2>AAAD_MEDCON</h2>
<pre class="r"><code># AAAD_MEDCON &lt;- as.data.frame(read_excel(&quot;/Users/mengnazhang/Desktop/ADSP_DataPrep_local/PRADI/Phenotype/2025/Raw/PRADI_AAAD_MEDCON_05122025.xlsx&quot;,sheet = &quot;Export Worksheet&quot;))

## extract all the unique data types
unique(sapply(AAAD_MEDCON, class))</code></pre>
<pre><code>## [[1]]
## [1] &quot;numeric&quot;
## 
## [[2]]
## [1] &quot;character&quot;
## 
## [[3]]
## [1] &quot;logical&quot;
## 
## [[4]]
## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<pre class="r"><code>str(AAAD_MEDCON, max.level = 99, list.len = 99999)</code></pre>
<details>
<summary>
Click for details
</summary>
<pre><code>## &#39;data.frame&#39;:    397 obs. of  256 variables:
##  $ SYSXM                     : num  7134193 7839953 7838803 7838853 7838933 ...
##  $ SYSIND                    : num  11010563 11368403 11368463 11368453 11368443 ...
##  $ SYSGP                     : num  7889553 7950923 7950983 7950973 7950963 ...
##  $ SYSGPSTUDY                : num  1304893 1396033 1396093 1396083 1396073 ...
##  $ SYSINDGP                  : num  7765583 8137673 8137733 8137723 8137713 ...
##  $ CGI_ORDER                 : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ GPS_ORDER                 : num  1 1 1 1 1 1 1 1 1 1 ...
##  $ STDCGI_ORDER              : num  11 11 11 11 11 11 11 11 11 11 ...
##  $ LSTUDY                    : chr  &quot;ADFAMPRADI&quot; &quot;ADCONTROL&quot; &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; ...
##  $ DB_OWNER                  : chr  &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; &quot;CLINIC_USER&quot; ...
##  $ STUDY                     : chr  &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; &quot;ALZ&quot; ...
##  $ SUBSTUDY                  : chr  &quot;ADFAMPRADI&quot; &quot;ADCONTROL&quot; &quot;ADCRLPRADI&quot; &quot;ADCRLPRADI&quot; ...
##  $ CENTER                    : chr  &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; &quot;IHG&quot; ...
##  $ GP                        : num  87580 88413 88419 88418 88417 ...
##  $ IND                       : num  1 1 1 1 1 100 1 1 1 1 ...
##  $ REFCTR                    : logi  NA NA NA NA NA NA ...
##  $ EXAM_DATE                 : POSIXct, format: &quot;2016-09-07&quot; &quot;2020-03-06&quot; ...
##  $ EXAMINER                  : chr  &quot;ladams4&quot; &quot;sjt82&quot; &quot;mxp1257&quot; &quot;mxp1257&quot; ...
##  $ DATE_OF_BIRTH             : POSIXct, format: &quot;1925-08-21&quot; &quot;1928-02-14&quot; ...
##  $ AGE_AT_EXAM               : num  91 92 74 75 75 64 83 77 79 85 ...
##  $ REVIEW_DATE               : logi  NA NA NA NA NA NA ...
##  $ REVIEWER                  : logi  NA NA NA NA NA NA ...
##  $ MEMORY_COMPLAINTS         : num  NA 1 0 0 0 1 0 0 0 0 ...
##  $ DATE_OF_ONSET             : POSIXct, format: NA NA ...
##  $ DOA_UNK                   : chr  NA &quot;U&quot; NA NA ...
##  $ DESCRIBE                  : chr  &quot;hello&quot; &quot;No family history of dementia.&quot; &quot;Brother with PD.&quot; &quot;Denies psychological/psychiatric conditions.  Brother, mother, aunt (father&#39;s sister) and grandparents with AD &quot;| __truncated__ ...
##  $ MEM_COMPLAINTS            : chr  NA &quot;misplaces objects  Informant: Daughter and self 92 YO widow female who lives with daughter and  visits senior c&quot;| __truncated__ &quot;None. Lives alone. Can cook, clean and take care of self. Fully capable of self care and fully oriented. Drives&quot;| __truncated__ &quot;none. denies memoery issues. Lives with daughter. can cook, clean and do chores but daughter helps. Says she co&quot;| __truncated__ ...
##  $ CURRENT_MED               : chr  NA NA &quot;Hypertension and Thyroid issues&quot; &quot;Hypertension + neuropathy + metformin&quot; ...
##  $ PMH                       : chr  NA &quot;HTN&quot; &quot;Hypertension and Thyroid issues&quot; NA ...
##  $ MOOD_CHANGES              : chr  NA &quot;denies&quot; &quot;denies.&quot; NA ...
##  $ MEDICATIONS               : chr  NA &quot;lisinopril, clopidogrel&quot; NA &quot;not collected&quot; ...
##  $ HYPERTENSION_DX           : num  NA 1 NA NA NA 1 NA 0 1 1 ...
##  $ HYPERTENSION_TREATED      : num  NA 1 NA NA NA 1 NA 0 NA NA ...
##  $ DIABETES_DX               : num  NA 0 NA NA NA 1 NA 0 0 1 ...
##  $ DIABETES_TREATED          : num  NA NA NA NA NA 1 NA 0 NA NA ...
##  $ MYOCARDIAL_DX             : num  NA 0 NA NA NA 0 NA 0 0 1 ...
##  $ MYOCARDIAL_TREATED        : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ HEART_FAILURE_DX          : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ HEART_FAILURE_TREATED     : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ HEART_DISEASE_DX          : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ HEART_DISEASE_TREATED     : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ COPD_DX                   : num  NA 0 NA NA NA 0 NA 0 0 1 ...
##  $ COPD_TREATED              : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ THYROID_DX                : num  NA 0 NA NA NA 0 NA 1 0 0 ...
##  $ THYROID_TREATED           : num  NA NA NA NA NA 0 NA 1 NA NA ...
##  $ LIVER_DX                  : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ LIVER_TREATED             : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ RENAL_DX                  : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ RENAL_TREATED             : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ PEPTIC_DX                 : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ PEPTIC_TREATED            : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ PERIPHERAL_DX             : num  NA 0 NA NA NA 0 NA 1 0 0 ...
##  $ PERIPHERAL_TREATED        : num  NA NA NA NA NA 0 NA 1 NA NA ...
##  $ STROKE_DX                 : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ STROKE_TREATED            : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ TIA_DX                    : num  NA 0 NA NA NA 0 NA 0 0 1 ...
##  $ TIA_TREATED               : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ HEAD_INJURY_DX            : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ HEAD_INJURY_TREATED       : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ SEIZURE_DX                : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ SEIZURE_TREATED           : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ CANCER_DX                 : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ CANCER_TREATED            : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ ARTHRITIS_DX              : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ ARTHRITIS_TREATED         : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ SYPHILIS_DX               : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ SYPHILIS_TREATED          : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ ALCOHOL_DX                : num  NA 0 NA NA NA 0 NA 0 0 1 ...
##  $ ALCOHOL_TREATED           : num  NA NA NA NA NA 0 NA 0 0 9 ...
##  $ ILLICIT_DRUG_DX           : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ ILLICIT_DRUG_TREATED      : num  NA NA NA NA NA 0 NA 0 0 9 ...
##  $ SMOKING_DX                : num  NA 0 NA NA NA 0 NA 0 0 1 ...
##  $ SMOKING_TREATED           : num  NA NA NA NA NA 0 NA 0 0 9 ...
##  $ PD_DX                     : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ PD_TREATED                : num  NA NA NA NA NA 0 NA 0 0 9 ...
##  $ HUNTINGTON_DX             : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ HUNTINGTON_TREATED        : num  NA NA NA NA NA 0 NA 0 0 9 ...
##  $ MULTIPLE_SCLEROSIS_DX     : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ MULTIPLE_SCLEROSIS_TREATED: num  NA NA NA NA NA 0 NA 0 NA 9 ...
##  $ B12_DX                    : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ B12_TREATED               : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ HYDROCEPHALUS_DX          : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ HYDROCEPHALUS_TREATED     : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ TREMOR_DX                 : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ TREMOR_TREATED            : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ DOWN_SYNDROME_DX          : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ DOWN_SYNDROME_TREATED     : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ MED_CONDITIONS_DX         : num  NA 0 NA NA NA 0 NA 0 0 0 ...
##  $ MED_CONDITIONS_TREATED    : num  NA NA NA NA NA 0 NA 0 NA NA ...
##  $ OTH_MED_COND_SP           : chr  NA NA NA NA ...
##  $ STROKE_BRAIN              : num  NA 0 NA NA NA 0 NA 0 9 1 ...
##  $ DOCTOR                    : num  NA NA NA NA NA 0 NA 0 9 1 ...
##  $ STROKE_PAST               : num  NA NA NA NA NA 0 NA 0 9 1 ...
##  $ STROKE_24HRS              : num  NA NA NA NA NA 0 NA 0 9 0 ...
##  $ SYMPTOMS                  : num  NA NA NA NA NA 0 NA 0 9 0 ...
##  $ LOST_SPEECH               : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ LOST_UNDERSTAND           : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ LOSS_CONSCIOUS            : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ WEAKNESS                  : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ NUMBNESS                  : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ LOSS_VISION               : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ HALF_VISION               : num  NA 0 NA NA NA 0 NA 0 9 9 ...
##  $ PERIOD                    : num  NA 9 NA NA NA 9 NA 0 9 0 ...
##  $ AGE                       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DONT_KNOW                 : chr  NA NA NA NA ...
##  $ SEEK_HELP                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ TREATMENT                 : num  NA NA NA NA NA NA NA 0 NA NA ...
##  $ MEDS                      : num  NA NA NA NA NA NA NA 0 NA NA ...
##  $ PSYCHOTHERAPY             : num  NA NA NA NA NA NA NA 0 NA NA ...
##  $ OTHER                     : num  NA NA NA NA NA NA NA 0 NA NA ...
##  $ SPECIFY                   : chr  NA NA NA NA ...
##  $ UNKNOWN                   : num  NA NA NA NA NA NA NA 0 NA NA ...
##  $ TAKING_MEDS               : num  NA NA NA NA NA NA NA 1 NA NA ...
##  $ MEDICATION1               : chr  NA NA NA NA ...
##  $ STRENGTH1                 : chr  NA NA NA NA ...
##  $ SEEN1                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN1_SPEC                : chr  NA NA NA NA ...
##  $ MEDICATION2               : chr  NA NA NA NA ...
##  $ STRENGTH2                 : chr  NA NA NA NA ...
##  $ SEEN2                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN2_SPEC                : chr  NA NA NA NA ...
##  $ MEDICATION3               : chr  NA NA NA NA ...
##  $ STRENGTH3                 : chr  NA NA NA NA ...
##  $ SEEN3                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN3_SPEC                : chr  NA NA NA NA ...
##  $ MEDICATION4               : chr  NA NA NA NA ...
##  $ STRENGTH4                 : chr  NA NA NA NA ...
##  $ SEEN4                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN4_SPEC                : chr  NA NA NA NA ...
##  $ MEDICATION5               : chr  NA NA NA NA ...
##  $ STRENGTH5                 : chr  NA NA NA NA ...
##  $ SEEN5                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN5_SPEC                : logi  NA NA NA NA NA NA ...
##  $ MEDICATION6               : chr  NA NA NA NA ...
##  $ STRENGTH6                 : chr  NA NA NA NA ...
##  $ SEEN6                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN6_SPEC                : logi  NA NA NA NA NA NA ...
##  $ MEDICATION7               : chr  NA NA NA NA ...
##  $ STRENGTH7                 : chr  NA NA NA NA ...
##  $ SEEN7                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN7_SPEC                : logi  NA NA NA NA NA NA ...
##  $ MEDICATION8               : chr  NA NA NA NA ...
##  $ STRENGTH8                 : chr  NA NA NA NA ...
##  $ SEEN8                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN8_SPEC                : logi  NA NA NA NA NA NA ...
##  $ MEDICATION9               : chr  NA NA NA NA ...
##  $ STRENGTH9                 : chr  NA NA NA NA ...
##  $ SEEN9                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN9_SPEC                : logi  NA NA NA NA NA NA ...
##  $ MEDICATION10              : chr  NA NA NA NA ...
##  $ STRENGTH10                : chr  NA NA NA NA ...
##  $ SEEN10                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN10_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION11              : chr  NA NA NA NA ...
##  $ STRENGTH11                : chr  NA NA NA NA ...
##  $ SEEN11                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN11_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION12              : chr  NA NA NA NA ...
##  $ STRENGTH12                : chr  NA NA NA NA ...
##  $ SEEN12                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN12_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION13              : chr  NA NA NA NA ...
##  $ STRENGTH13                : chr  NA NA NA NA ...
##  $ SEEN13                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN13_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION14              : chr  NA NA NA NA ...
##  $ STRENGTH14                : chr  NA NA NA NA ...
##  $ SEEN14                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN14_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION15              : chr  NA NA NA NA ...
##  $ STRENGTH15                : logi  NA NA NA NA NA NA ...
##  $ SEEN15                    : logi  NA NA NA NA NA NA ...
##  $ SEEN15_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION16              : chr  NA NA NA NA ...
##  $ STRENGTH16                : logi  NA NA NA NA NA NA ...
##  $ SEEN16                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN16_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION17              : chr  NA NA NA NA ...
##  $ STRENGTH17                : logi  NA NA NA NA NA NA ...
##  $ SEEN17                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SEEN17_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION18              : logi  NA NA NA NA NA NA ...
##  $ STRENGTH18                : logi  NA NA NA NA NA NA ...
##  $ SEEN18                    : logi  NA NA NA NA NA NA ...
##  $ SEEN18_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION19              : logi  NA NA NA NA NA NA ...
##  $ STRENGTH19                : logi  NA NA NA NA NA NA ...
##  $ SEEN19                    : logi  NA NA NA NA NA NA ...
##  $ SEEN19_SPEC               : logi  NA NA NA NA NA NA ...
##  $ MEDICATION20              : logi  NA NA NA NA NA NA ...
##  $ STRENGTH20                : logi  NA NA NA NA NA NA ...
##  $ SEEN20                    : logi  NA NA NA NA NA NA ...
##  $ SEEN20_SPEC               : logi  NA NA NA NA NA NA ...
##  $ NOTES                     : chr  NA NA NA NA ...
##  $ WARFARIN                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ASPIRIN                   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTIPLATELETS             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DIURETICS                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTICONVULSANTS           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ INSULIN                   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ HYPOGLYCEMICS             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SULFONYLUREA              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ METFORMIN                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ GLITAZONES                : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DIGITALIS                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ NITRATES                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ CALCIUM_CHANNEL           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ BETA_2_AGAONIST           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ BETA_BLOCKERS             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ACE                       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTI_ARRHYTHMICS          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTI_HYPERLIPIDEMICS      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ STATIN_DRUG               : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FIBRATE_DRUG              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ THYROID                   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTICHOLINERGICS          : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ LEVODOPA                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DOPAMINE                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTIDEPRESSANTS           : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANTIPSYCHOTICS            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ANXIOLYTICS               : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ CHOLINESTERASE            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ RIVASTIGMINE              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ TACRINE                   : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DONEPEZIL                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ GALANTAMINE               : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ NMDA                      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ MEMANTINE                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ALPHA_BLOCKERS            : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ HYPNOTICS                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ H1_BLOCKERS               : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ H2_BLOCKERS               : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ NSAID                     : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ COX2                      : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ NARCOTICS                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ HYDERGINE                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DEPRENYL                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ ESTROGEN_SUPP             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ PRESCRIPTION              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ OTC                       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ STEROIDS                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ OTHER_MEDS                : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ SPEC_MEDS                 : chr  NA NA NA NA ...
##  $ MULTIVITAMINS             : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ VITAMIN_C                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ VITAMIN_E                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ VITAMINE_B12              : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ COENZYME_Q                : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ DHA                       : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ LECITHIN                  : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ GINKGO                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ FOLIC_ACID                : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ VITAMIN_B6                : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ VITAMIN_D                 : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ OMEGA3                    : num  NA NA NA NA NA NA NA NA NA NA ...
##  $ MEDCOND_COMENTS           : logi  NA NA NA NA NA NA ...</code></pre>
</details>
<p><br></p>
<div id="pull-the-regenerated-dd" class="section level3">
<h3>Pull the regenerated DD</h3>
<pre class="r"><code>DD_AAAD_MEDCON &lt;- read_excel(&quot;/Users/mengnazhang/Desktop/ADSP_DataPrep_local/PRADI/Phenotype/2025/Clean/colnamesPerSubdata.xlsx&quot;, sheet = &quot;AAAD_MEDCON&quot;)</code></pre>
<p><br></p>
</div>
<div id="handling-logical-variables" class="section level3">
<h3>Handling Logical Variables</h3>
<pre class="r"><code>## extract all logical variables
logicols &lt;- colnames(AAAD_MEDCON)[sapply(AAAD_MEDCON, is.logical)] ## 33 vars

## view those variables in the regeneraed DD
DD_AAAD_MEDCON[DD_AAAD_MEDCON$VarNames %in% logicols,c(&quot;VarNames&quot;,&quot;Data Type&quot;)]</code></pre>
<pre><code>## # A tibble: 33 × 2
##    VarNames    `Data Type`  
##    &lt;chr&gt;       &lt;chr&gt;        
##  1 REFCTR      VARCHAR2(6)  
##  2 REVIEW_DATE &lt;NA&gt;         
##  3 REVIEWER    &lt;NA&gt;         
##  4 SEEN5_SPEC  VARCHAR2(100)
##  5 SEEN6_SPEC  NUMBER(1)    
##  6 SEEN7_SPEC  VARCHAR2(100)
##  7 SEEN8_SPEC  NUMBER(1)    
##  8 SEEN9_SPEC  VARCHAR2(100)
##  9 SEEN10_SPEC NUMBER(1)    
## 10 SEEN11_SPEC VARCHAR2(100)
## # ℹ 23 more rows</code></pre>
<pre class="r"><code>## select the vars to be converted to numeric
convert2num &lt;- DD_AAAD_MEDCON$VarNames[DD_AAAD_MEDCON$VarNames %in% logicols &amp; grepl(&quot;NUMBER&quot;, DD_AAAD_MEDCON$`Data Type`)] ## 10 vars

## select the vars to be converted to character, since I did not see any variables should be converted to date type, I will then convert the rest to chracters
convert2chr &lt;- setdiff(logicols,convert2num) ## 23 vars

## convert
AAAD_MEDCON[convert2num] &lt;- lapply(AAAD_MEDCON[convert2num], as.numeric)
AAAD_MEDCON[convert2chr] &lt;- lapply(AAAD_MEDCON[convert2chr], as.character)

## recheck the unique data types
unique(sapply(AAAD_MEDCON, class))</code></pre>
<pre><code>## [[1]]
## [1] &quot;numeric&quot;
## 
## [[2]]
## [1] &quot;character&quot;
## 
## [[3]]
## [1] &quot;POSIXct&quot; &quot;POSIXt&quot;</code></pre>
<p><br></p>
</div>
<div id="handling-date-variables" class="section level3">
<h3>Handling Date Variables</h3>
<pre class="r"><code>## extract date variables from sub-dataset
datecols &lt;- colnames(AAAD_MEDCON)[sapply(AAAD_MEDCON, function(x) inherits(x, c(&quot;POSIXct&quot;, &quot;POSIXt&quot;)))] ## [1] &quot;EXAM_DATE&quot; &quot;DATE_OF_BIRTH&quot; &quot;DATE_OF_ONSET&quot;

## extarc date variables from regenerated DD
datecolsFromDD &lt;- DD_AAAD_MEDCON$VarNames[DD_AAAD_MEDCON$`Data Type` %in% c(&quot;DATE&quot;,&quot;date&quot;)]

## compare the two to see if we missing any date variables
setdiff(datecols,datecolsFromDD)</code></pre>
<pre><code>## character(0)</code></pre>
<pre class="r"><code>head(AAAD_MEDCON[,datecols])</code></pre>
<pre><code>##    EXAM_DATE DATE_OF_BIRTH DATE_OF_ONSET
## 1 2016-09-07    1925-08-21          &lt;NA&gt;
## 2 2020-03-06    1928-02-14          &lt;NA&gt;
## 3 2020-03-06    1945-09-01          &lt;NA&gt;
## 4 2020-03-06    1944-03-22          &lt;NA&gt;
## 5 2020-03-06    1944-10-17          &lt;NA&gt;
## 6 2020-03-05    1955-06-26    2016-09-09</code></pre>
<pre class="r"><code>## convert format
AAAD_MEDCON[datecols] &lt;- lapply(AAAD_MEDCON[datecols], as.Date)

## recheck the unique data types
unique(sapply(AAAD_MEDCON, class))</code></pre>
<pre><code>## [1] &quot;numeric&quot;   &quot;character&quot; &quot;Date&quot;</code></pre>
<p><br></p>
</div>
<div id="handling-chracter-variables" class="section level3">
<h3>Handling Chracter Variables</h3>
<pre class="r"><code>## extract characteristic variables from sub-dataset
chrcols &lt;- colnames(AAAD_MEDCON)[sapply(AAAD_MEDCON, is.character)] ## 76 vars

## extract characteristic variables with finite values
DD_AAAD_MEDCON[grepl(&quot;CHAR|VARCHAR&quot;, DD_AAAD_MEDCON$`Data Type`, ignore.case = TRUE) &amp; !is.na(DD_AAAD_MEDCON$`Valid Responses`),
               c(&quot;VarNames&quot;,&quot;Valid Responses&quot;)]</code></pre>
<pre><code>## # A tibble: 1 × 2
##   VarNames  `Valid Responses`
##   &lt;chr&gt;     &lt;chr&gt;            
## 1 DONT_KNOW DK;</code></pre>
<pre class="r"><code>## check unique values of those variables in the sub-dataset
unique(AAAD_MEDCON$DONT_KNOW) </code></pre>
<pre><code>## [1] NA   &quot;DK&quot;</code></pre>
<pre class="r"><code>## for all characteristic variables, double check their data type in the DD, pull out mismatched cases
dismatchChrs &lt;- DD_AAAD_MEDCON[
  DD_AAAD_MEDCON$VarNames %in% chrcols &amp;
  !is.na(DD_AAAD_MEDCON$`Data Type`) &amp;
  !grepl(&quot;^(varchar|char)&quot;, DD_AAAD_MEDCON$`Data Type`, ignore.case = TRUE),
  c(&quot;VarNames&quot;,&quot;Data Type&quot;)]

print(dismatchChrs)</code></pre>
<pre><code>## # A tibble: 3 × 2
##   VarNames   `Data Type`
##   &lt;chr&gt;      &lt;chr&gt;      
## 1 DOA_UNK    NUMBER(1)  
## 2 SEEN2_SPEC NUMBER(1)  
## 3 SEEN4_SPEC NUMBER(1)</code></pre>
<pre class="r"><code>## double check thier values and convert those to numeric if necessary

## DOA_UNK: I checked the DD and believe that DOA_UNK should be character
## SEEN2_SPEC: in the DD, this variable should be 0/1, but in the dataset it gots unique values: &quot;10 mg b.i.d.&quot; &quot;Duloxetine 60 mg q.d.&quot;, will contact cohort for this variable
## SEEN4_SPEC: in the DD, this variables should be 0/1, but in the dataset it gots unique values: &quot;80 mg b.i.d.&quot;, will contact cohort for this variable as well.</code></pre>
<p><br></p>
</div>
<div id="handling-numeric-variables" class="section level3">
<h3>Handling Numeric Variables</h3>
<pre class="r"><code>## extract numeric variables from sub-dataset
numcols &lt;- colnames(AAAD_MEDCON)[sapply(AAAD_MEDCON, is.numeric)] ## 177 vars

## extract numeric variables from DD
numcolsFromDD &lt;- DD_AAAD_MEDCON[grepl(&quot;number&quot;, DD_AAAD_MEDCON$`Data Type`, ignore.case = TRUE),
                                c(&quot;VarNames&quot;,&quot;Valid Responses&quot;)]

## remove &quot;DOA_UNK&quot; column as it should be character
numcolsFromDD &lt;- subset(numcolsFromDD,VarNames != &quot;DOA_UNK&quot;)
table(numcolsFromDD$`Valid Responses`,useNA = &quot;ifany&quot;)</code></pre>
<pre><code>## 
##                   0;\r\n1; 0;\r\n1;\r\n7;\r\n8;\r\n9; 
##                         27                         12 
##             0;\r\n1;\r\n9;      0;\r\n1;\r\n9;\r\n-1; 
##                         62                         58 
##               1 thru 9999;              1 thru 99999; 
##                          1                          1 
##                       &lt;NA&gt; 
##                          2</code></pre>
<pre class="r"><code>## Check numeric variables with unique values: 0/1
numcols_sub1 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;0;\r\n1;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
uniqueValCheck(AAAD_MEDCON,c(0,1),numcols_sub1)</code></pre>
<pre><code>## SEEN2_SPEC :
## [1] &quot;10 mg b.i.d.&quot;          &quot;Duloxetine 60 mg q.d.&quot;
## 
## SEEN4_SPEC :
## [1] &quot;80 mg b.i.d.&quot;</code></pre>
<pre class="r"><code>## two variables pops up: SEEN2_SPEC and SEEN4_SPEC, we ignore them for now, as these are also the problematic found in the last step

## Check numeric variables with unique values: 0/1/7/8/9
numcols_sub2 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;0;\r\n1;\r\n7;\r\n8;\r\n9;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
uniqueValCheck(AAAD_MEDCON,c(0,1,7,8,9),numcols_sub2) ## all passed

## Check numeric variables with unique values: 0/1/9
numcols_sub3 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;0;\r\n1;\r\n9;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
uniqueValCheck(AAAD_MEDCON,c(0,1,9),numcols_sub3) ## all passed

## Check numeric variables with unique values: 0/1/9/-1
numcols_sub4 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;0;\r\n1;\r\n9;\r\n-1;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
uniqueValCheck(AAAD_MEDCON,c(0,1,9,-1),numcols_sub4) ## all passed

## Check numeric variables within value range:1 thru 9999;
numcols_sub5 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;1 thru 9999;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
range(AAAD_MEDCON[[numcols_sub5]]) ## passed</code></pre>
<pre><code>## [1]    1 9041</code></pre>
<pre class="r"><code>## Check numeric variables within value range:1 thru 99999;
numcols_sub6 &lt;- numcolsFromDD$VarNames[numcolsFromDD$`Valid Responses` ==&quot;1 thru 99999;&quot; &amp; !is.na(numcolsFromDD$`Valid Responses`)]
range(AAAD_MEDCON[[numcols_sub6]]) ## the maximum values is 104530 in the dataset, but I think this is okay. So passes.</code></pre>
<pre><code>## [1]  87502 104530</code></pre>
<pre class="r"><code>## For all numeric variables, double check their datatype with DD
mismatchNums &lt;- DD_AAAD_MEDCON[
  DD_AAAD_MEDCON$VarNames %in% numcols &amp;
  !is.na(DD_AAAD_MEDCON$`Data Type`) &amp;
  !grepl(&quot;number&quot;, DD_AAAD_MEDCON$`Data Type`, ignore.case = TRUE),
  c(&quot;VarNames&quot;,&quot;Data Type&quot;)]

## view the mismatched variables
print(mismatchNums)</code></pre>
<pre><code>## # A tibble: 8 × 2
##   VarNames `Data Type` 
##   &lt;chr&gt;    &lt;chr&gt;       
## 1 SEEN2    VARCHAR2(30)
## 2 SEEN4    VARCHAR2(30)
## 3 SEEN6    VARCHAR2(30)
## 4 SEEN8    VARCHAR2(30)
## 5 SEEN10   VARCHAR2(30)
## 6 SEEN12   VARCHAR2(30)
## 7 SEEN14   VARCHAR2(30)
## 8 SEEN16   VARCHAR2(30)</code></pre>
<pre class="r"><code>## check these mismatched variables unique values in the dataset
lapply(AAAD_MEDCON[mismatchNums$VarNames], unique)</code></pre>
<pre><code>## $SEEN2
## [1] NA  0  1
## 
## $SEEN4
## [1] NA  0  1
## 
## $SEEN6
## [1] NA  0  1
## 
## $SEEN8
## [1] NA  0  1
## 
## $SEEN10
## [1] NA  0  1
## 
## $SEEN12
## [1] NA  0
## 
## $SEEN14
## [1] NA  0
## 
## $SEEN16
## [1] NA  0</code></pre>
<pre class="r"><code>## as these variables do have values 0/1 that not being mentioned in the DD, we need to ask the Cohort before handling them.
## To me, these variables do look like to be numeric variables, we probably need to update the data dictionary
## I check the DD, for similar variables like SEEN15, SEEN13, the DD do code them as numeric with 0 means &quot;No&quot; and 1 means &quot;Yes&quot;.
## those are pair variables: SEENx and SEENx_SPEC, my understanding is that SEENx should be numeric and SEENx_SPEC should be characteristics. But clearly, the DD make them not consistently across all the pairs. </code></pre>
</div>
</div>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1,h2,h3",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
